<!DOCTYPE html>
<html>
<head>
    <title>VEN Search</title>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background: #f4f6f9;
            text-align: center;
            padding: 60px;
        }
        h1 { color: #333; }
        input { width: 400px; padding: 12px; font-size: 16px; border-radius: 8px; border: 1px solid #ccc; outline: none; margin:5px; }
        input:focus { border-color: #4CAF50; }

        .results { margin-top: 40px; display: flex; justify-content: center; flex-wrap: wrap; gap: 20px; }
        .card { background: white; padding: 20px; width: 300px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); text-align: left; }
        .ven { font-size: 20px; font-weight: bold; color: #4CAF50; }
        .name { margin-top: 8px; font-size: 16px; }
        .location { margin-top: 5px; color: #777; }

        .add-form { margin-top: 50px; }
        button { padding: 8px 16px; margin-top: 5px; cursor: pointer; }
    </style>
</head>
<body>

<h1>VEN Search</h1>
<input type="text" id="searchBox" placeholder="Search Column A (VEN)..." onkeyup="search()">

<div class="results" id="results"></div>

<!-- ADD ENTRY FORM -->
<div class="add-form">
    <h2>Add New Entry</h2>
    <input type="text" id="ven" placeholder="VEN">
    <input type="text" id="name" placeholder="Name">
    <input type="text" id="location" placeholder="Location">
    <br>
    <button onclick="addEntry()">Add Entry</button>
</div>

<script>
// Search function
function search() {
    let q = document.getElementById("searchBox").value;
    fetch("/search?q=" + q)
        .then(res => res.json())
        .then(data => {
            let resultsDiv = document.getElementById("results");
            resultsDiv.innerHTML = "";

            data.forEach(row => {
                let card = document.createElement("div");
                card.className = "card";
                card.innerHTML = `
                    <div class="ven">${row.VEN}</div>
                    <div class="name">${row.NAME}</div>
                    <div class="location">${row.LOCATION}</div>
                `;
                resultsDiv.appendChild(card);
            });
        });
}

// Add new entry function
function addEntry() {
    let ven = document.getElementById("ven").value.trim();
    let name = document.getElementById("name").value.trim();
    let location = document.getElementById("location").value.trim();

    if(!ven || !name) {
        alert("VEN and Name are required!");
        return;
    }

    fetch("/add", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ VEN: ven, NAME: name, LOCATION: location })
    })
    .then(res => res.json())
    .then(data => {
        if(data.status === "success") {
            alert("Entry added!");
            document.getElementById("ven").value = "";
            document.getElementById("name").value = "";
            document.getElementById("location").value = "";
            search(); // Refresh search results
        }
    });
}
</script>

</body>
</html>